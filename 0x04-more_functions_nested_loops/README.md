more functions on this files, and nested loops
